# パチスロデータ取得

## 定数データ（config.py などで一元化）

- 初期URL
- 対象となる都道府県
- ホール名
- 取得期間
- データベースのパス
- csvのパス
- マジックナンバーなし

## スクレイピング＋CSV保存（scrape_and_save.py 前処理なし）

- CSVの整形はせず抽出データをそのまま保存
- ChromeDriver設定
    - Options()（ヘッドレス、User-Agentなど）
    - ウインドウサイズ
- スクレイピング防止対策
    - Waitの設定
    - スクロール設定
- 広告対策
    - 例：try: driver.find_element(...).click()
- logger設定
    - logging によるログ出力（時間・処理結果を記録）

## csv の前処理及び、データベースに保存するファイル

### 不要情報の削除

- 不要情報の削除
    - 不要な列の削除（例：出力日、空白列など）
    - カンマ・空白・+・円などの記号削除

### DB テーブル構成

- prefectures
    - prefecture_id (PK)
    - name

- halls
    - hall_id (PK)
    - name

- models
    - model_id (PK)
    - name

- results
    - hall_id (PK)
    - model_id (FK)
    - date
    - game
    - BB
    - RB
    - medals

### ユニーク制約

- UNIQUE (hall_id, unit_no, date)：1台あたり1日1件のみ

## データベース分析用（analyze.py など）

### 分析用項目の算出

- 確率カラム
    - total_rate = (BB + RB) / games
    - bb_rate = BB / games
    - rb_rate = RB / games
- 日付分解カラム
    - month（YYYY-MM）
    - day（DD）
    - weekday（日本語で月曜〜日曜 or 数値0〜6）

### 統計データの抽出

## ディレクトリ構成

```arduino
pachislo_project/
│
├─ config/                      ← 初期設定（定数）
│   └─ config.py
│
├─ scraper/
│   └─ scrape_and_save.py       ← スクレイピング処理
│
├─ preprocess/
│   └─ insert_with_pandas.py    ← CSV整形＆DB登録
│
├─ analysis/
│   └─ analyze.py               ← 分析・可視化
│
├─ data/
│   └─ 東京都_EXA_FIRST_2025-04-03.csv
│
├─ anaslo_02/
│   └─ anaslo_02.db             ← SQLiteデータベース

```

## 将来的な拡張も意識

- 日付の自動取得＆スケジューリング（例：cron + headless Chrome）
- Next.jsでWeb可視化
- XGBoostやランダムフォレストによる設定推定モデル


## 機種別確率

### SアイムジャグラーEX-TP

打ち方別出玉率
設定	公表値	チェリー狙い	フル攻略
1	97.0%	97.97%	98.70%
2	98.0%	99.09%	99.82%
3	99.5%	100.75%	101.48%
4	101.1%	102.53%	103.27%
5	103.3%	104.93%	105.66%
6	105.5%	107.29%

通常時ブドウ確率
設定	確率
1	1/6.02
2
3
4
5
6	1/5.78

設定 単独REG	チェリーREG
1	1/630.15	1/1456.36
2	1/574.88	1/1310.72
3	1/474.90	1/1092.27
4	1/448.88	1/1057.03
5	1/364.09	1/851.12


## SマイジャグラーV

打ち方別出玉率
設定	公表値	チェリー狙い	フル攻略
1	97.0%	97.83%	98.61%
2	98.0%	98.95%	99.73%
3	99.9%	101.19%	101.97%
4	102.8%	104.31%	105.09%
5	105.3%	107.19%	107.97%
6	109.4%	111.65%	112.44%


通常時小役確率
設定	ブドウ	非重複チェリー	ピエロ・ベル
1	1/5.90	1/38.10	1/1024.0
2	1/5.85
3	1/5.80	1/36.82
4	1/5.78	1/35.62
5	1/5.76
6	1/5.66

単独ボーナス確率
設定	BIG	REG
1	1/409.60	1/655.36
2	1/407.06	1/601.25
3	1/399.61	1/492.75
4	1/378.82	1/407.06
5	1/354.25	1/390.10
6	1/337.81	1/327.68
チェリー重複ボーナス確率
設定	BIG	REG
1	1/1424.70	1/1092.27
2	1/1394.38	1/1074.36
3	1/1365.33	1/1057.03
4	1/1285.02	1/1008.25
5	1/1213.63	1/862.32
6	1/1129.93	1/762.05

ボーナス確率
設定値	BIG確率	REG確率
設定1	1/273.07	1/409.60
設定2	1/270.81	1/385.51
設定3	1/266.41	1/336.08
設定4	1/254.02	1/289.98
設定5	1/240.06	1/268.59
設定6	1/229.15	1/229.15
